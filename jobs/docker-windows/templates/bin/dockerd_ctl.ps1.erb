trap { $host.SetShouldExit(1) }

# Proxy configuration is set via env vars

<% if_link('docker') do |docker| %>
  # docker link present
  <% docker.if_p('env.http_proxy') do |http_proxy| %>
$env:HTTP_PROXY = <%= http_proxy %>
  <% end %>
  <% docker.if_p('env.https_proxy') do |https_proxy| %>
$env:HTTPS_PROXY = <%= https_proxy %>
  <% end %>
  <% docker.if_p('env.no_proxy') do |no_proxy| %>
$env:NO_PROXY = <%= no_proxy %>
  <% end %>
<% end %>

# TODO for now, hardcode proxy settings for testing
$env:HTTP_PROXY = "10.87.30.201:8888"
$env:HTTPS_PROXY = "10.87.30.201:8888"
$env:NO_PROXY = ".internal,.svc,.svc.cluster.local,.svc.cluster,192.167.20.0/16,192.168.20.0/16,10.87.30.0/24"

C:\var\vcap\packages\docker-windows\docker\dockerd
